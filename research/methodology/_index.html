<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.4">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="_index_files/libs/clipboard/clipboard.min.js"></script>
<script src="_index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="_index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="_index_files/libs/quarto-html/popper.min.js"></script>
<script src="_index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="_index_files/libs/quarto-html/anchor.min.js"></script>
<link href="_index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="_index_files/libs/quarto-html/quarto-syntax-highlighting-19cd9126a9a9c64aacb03dc90954a64a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="_index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="_index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="_index_files/libs/bootstrap/bootstrap-54e3e7770afa53bb57f7dd5e90680ac5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="methodology" class="level1">
<h1>Methodology</h1>
<section id="research-design-and-methods" class="level2">
<h2 class="anchored" data-anchor-id="research-design-and-methods">Research Design and Methods</h2>
<p><span class="citation" data-cites="baytas3KindsDesign2020">(<a href="#ref-baytas3KindsDesign2020" role="doc-biblioref">Baytaş, 2020</a>)</span> categorizes design research into three modes: (1) conducting research to inform design decisions, (2)studying designs to generate knowledge, and (3) using design itself as a means of inquiry. My research is of the 1st category, aiming make better design design decisions for my sustainability-focused financial app. When developing my research design, I relied on the advice of <span class="citation" data-cites="christianrohrerWhenUseWhich2022">(<a href="#ref-christianrohrerWhenUseWhich2022" role="doc-biblioref">Christian Rohrer, 2022</a>)</span> to decide when to choose which user experience research methods.</p>
<p>Overview of research methods.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Group</th>
<th>Task</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Experts (Finance)</td>
<td>Interview</td>
</tr>
<tr class="even">
<td>Experts (Design)</td>
<td>Interview</td>
</tr>
<tr class="odd">
<td>Experts (Sustainability)</td>
<td>Interview</td>
</tr>
<tr class="even">
<td>Target Audience (College Students)</td>
<td>Survey</td>
</tr>
<tr class="odd">
<td>Target Audience (College Students)</td>
<td>Prototype Testing</td>
</tr>
</tbody>
</table>
<p>This mixed-method research design is divided into three stages.</p>
<section id="phase-one---qualitative-research" class="level3">
<h3 class="anchored" data-anchor-id="phase-one---qualitative-research">Phase One - Qualitative Research</h3>
<p>My purpose for the first qualitative stage is to explore the general themes arising from the literature review related to the design of AI advisors for investing. I identifed specific user experience factors, through interviewing experts in financial technology and user experience design and reviewing existing applications on the marketplace. At this stage in the research, the central concept being studied was defined generally as expectations towards a sustainable investment AI advisor.</p>
<p>I started with literature review, which led into expert interviews (there were many questions arising from the literature). I identified key concepts from expert discussions and gained exposure to their industry insights.</p>
<p>The qualitative research methods employed in the first stage of the research design enables me to explore concepts arising for literature review further, using a more open approach, without limiting the conversation only to pre-ascribed notions. The strength of the qualitative approach in the first stage is to encourage the discovery of new ideas, not yet common in literature and potential user experience factors related to sustainable investing and user experience.</p>
<section id="sampling" class="level4">
<h4 class="anchored" data-anchor-id="sampling">Sampling</h4>
<p>My qualitative sampling structure used non-probability snowball sampling, with the following criteria: targeting financial industry, fintech, design, and sustainability experts; located everywhere.</p>
</section>
<section id="methods" class="level4">
<h4 class="anchored" data-anchor-id="methods">Methods</h4>
<p>I conducted exploratory research in English using semi-structured interviews recorded online and offline. I talked to 5 experts over video call and 1 one expert face-to-face; all interviews were conducted in English. I recorded audio and video, transcribed the conversations, and then performed thematic analysis of the contents, leading to a <em>wish list</em> of features.</p>
</section>
<section id="conceptual-framework" class="level4">
<h4 class="anchored" data-anchor-id="conceptual-framework">Conceptual Framework</h4>
<p>The conceptual framework map presents the key concepts arising from the literature review thus far in the research process. I’m using these concepts when developing interview strategies for phase one of the research, developing the survey questionnaire for phase two, as well as for building the Green Filter AI Companion for young adults at the final stage of the process. However, I expect the conceptual framework to further evolve with additional findings while conducting my research.</p>
<p>Conceptual Model</p>
</section>
</section>
<section id="phase-two---quantitative-research" class="level3">
<h3 class="anchored" data-anchor-id="phase-two---quantitative-research">Phase Two - Quantitative Research</h3>
<p>I then proceeded to the second, quantitative stage, informed by the previously identified factors, and prepared a survey to understand potential users’ preferences, including a Likert scale, a choice experiment, and a selection of proposed features, focusing on the preferences of the potential users in gen-z, aged 18-29, living in Taiwan, exploring the relationship between independent variables: - “Interest in Sustainability” - “Interest in Investing” - “Preferred Features” - and the dependent variable “User Sign-ups”.</p>
<p>The strength of quantitative research is to enable me to access a larger sample of potential users in two countries, using online survey methods, and to validate some of the qualitative findings from stage one.</p>
<section id="sampling-1" class="level4">
<h4 class="anchored" data-anchor-id="sampling-1">Sampling</h4>
<p>My quantitative sampling structure uses a judgmental criterion: adults aged in Generation-Z (18-29), located in Taiwan, surveyed using a Chinese-language online survey.</p>
</section>
<section id="methods-1" class="level4">
<h4 class="anchored" data-anchor-id="methods-1">Methods</h4>
<p>Likert: The survey includes a Likert scale between 1 to 5 to validate key findings from the first stage of the research by assessing responses to statements regarding the app’s design, features, and other criteria that may still emerge.Choice Experiment: The survey includes a choice experiment between different sets of potential features available when communicating with the sustainable finance AI companion.</p>
</section>
<section id="data-collection" class="level4">
<h4 class="anchored" data-anchor-id="data-collection">Data Collection</h4>
<p>For my survey, I adopted a face-to-face method to increase response rates distributing flyers to students on college campuses, canteens, and classrooms, getting verbal permission from educators in their classrooms to distribute the survey flyer. Similarly to the approach take by <span class="citation" data-cites="liuDigitalCapabilityDigital2023">(<a href="#ref-liuDigitalCapabilityDigital2023" role="doc-biblioref">Liu et al., 2023</a>)</span>, I distributed the survey flyer at universities located in the Northern, Soutern, Central, and East regions of Taiwan. The flyer included a colorful AI-generated visual with a futuristic game-like female figure, and the title “climate anxiety survey” in Chinese, as well as a website link (ziran.tw) and scannable QR-code.</p>
<p>The survey only included questions and descriptions in Chinese. I have used the Claude 3 Opus model to translate them to English for this table.</p>
<table class="caption-top table">
<caption>36 Likert Fields included in the survey</caption>
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>Original Question in Chinese</th>
<th>English Translation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>如果你/妳懷疑你/妳要買的番茄可能是由強迫勞工（現代奴隸）採摘的，你/妳仍然會買它嗎？</td>
<td>If you suspect that the tomatoes you are going to buy may have been picked by forced labor (modern slaves), would you still buy them?</td>
</tr>
<tr class="even">
<td>你/妳關心食安嗎？</td>
<td>Do you care about food safety?</td>
</tr>
<tr class="odd">
<td>你/妳7年內買車嗎？🚘</td>
<td>Will you buy a car within 7 years? 🚘</td>
</tr>
<tr class="even">
<td>你/妳7年內買房嗎？🏡</td>
<td>Will you buy a house within 7 years? 🏡</td>
</tr>
<tr class="odd">
<td>你/妳購物時知道產品環保嗎？</td>
<td>Do you know if the products are environmentally friendly when you shop?</td>
</tr>
<tr class="even">
<td>你/妳覺得認證環保的公司更好嗎？</td>
<td>Do you think companies certified as environmentally friendly are better?</td>
</tr>
<tr class="odd">
<td>你/妳支持肉稅嗎？</td>
<td>Do you support a meat tax?</td>
</tr>
<tr class="even">
<td>你/妳關心食用雞的生活嗎？</td>
<td>Do you care about the lives of chickens raised for food?</td>
</tr>
<tr class="odd">
<td>你/妳避免吃肉嗎？</td>
<td>Do you avoid eating meat?</td>
</tr>
<tr class="even">
<td>你/妳覺得你/妳花錢會影響環境嗎？</td>
<td>Do you think your spending affects the environment?</td>
</tr>
<tr class="odd">
<td>你/妳會對金錢感到焦慮嗎？</td>
<td>Do you feel anxious about money?</td>
</tr>
<tr class="even">
<td>你/妳會對金錢很節儉嗎？</td>
<td>Are you very frugal with money?</td>
</tr>
<tr class="odd">
<td>你/妳會經常存錢嗎？</td>
<td>Do you often save money?</td>
</tr>
<tr class="even">
<td>你/妳對自己的財務知識滿意嗎？</td>
<td>Are you satisfied with your financial knowledge?</td>
</tr>
<tr class="odd">
<td>你/妳投資會考慮環保嗎？</td>
<td>Do you consider environmental protection when investing?</td>
</tr>
<tr class="even">
<td>你/妳覺得台灣的經濟目標是增長嗎？</td>
<td>Do you think Taiwan’s economic goal is growth?</td>
</tr>
<tr class="odd">
<td>你/妳覺台灣的得環境退化是台灣的經濟增長的前提嗎？</td>
<td>Do you think environmental degradation in Taiwan is a prerequisite for Taiwan’s economic growth?</td>
</tr>
<tr class="even">
<td>你/妳覺得台灣的經濟增長有助於保護環境嗎？</td>
<td>Do you think Taiwan’s economic growth helps protect the environment?</td>
</tr>
<tr class="odd">
<td>你/妳覺得經濟能不排CO₂eq也增長嗎？</td>
<td>Do you think the economy can grow without emitting CO₂eq?</td>
</tr>
<tr class="even">
<td>你/妳覺得經濟增長有物質限制嗎？</td>
<td>Do you think there are material limits to economic growth?</td>
</tr>
<tr class="odd">
<td>你/妳會每天都用AI嗎？</td>
<td>Do you use AI every day?</td>
</tr>
<tr class="even">
<td>你/妳會信任AI嗎？</td>
<td>Do you trust AI?</td>
</tr>
<tr class="odd">
<td>你/妳想要AI有個造型嗎？</td>
<td>Do you want AI to have a specific appearance?</td>
</tr>
<tr class="even">
<td>你/妳喜歡待在大自然嗎？</td>
<td>Do you like being in nature?</td>
</tr>
<tr class="odd">
<td>你/妳擔心氣候變化嗎？</td>
<td>Are you worried about climate change?</td>
</tr>
<tr class="even">
<td>你/妳對環境污染情況會感到焦慮嗎？</td>
<td>Do you feel anxious about environmental pollution?</td>
</tr>
<tr class="odd">
<td>你/妳知道許多植物和動物的名字嗎？</td>
<td>Do you know the names of many plants and animals?</td>
</tr>
<tr class="even">
<td>你/妳感覺自己和大自然很接近嗎？</td>
<td>Do you feel close to nature?</td>
</tr>
<tr class="odd">
<td>你/妳努力實踐低碳生活嗎？</td>
<td>Do you strive to live a low-carbon lifestyle?</td>
</tr>
<tr class="even">
<td>你/妳想做更多環保事嗎？</td>
<td>Do you want to do more for environmental protection?</td>
</tr>
<tr class="odd">
<td>你/妳對環境相關政治議題有興趣嗎？</td>
<td>Are you interested in environmental political issues?</td>
</tr>
<tr class="even">
<td>你/妳信任碳排放抵消額度嗎？</td>
<td>Do you trust carbon offset credits?</td>
</tr>
<tr class="odd">
<td>你/妳的環保行動對環境保護有效果嗎？</td>
<td>Do your environmental actions have an effect on environmental protection?</td>
</tr>
<tr class="even">
<td>你/妳想在行業內推環保嗎？</td>
<td>Do you want to promote environmental protection within your industry?</td>
</tr>
<tr class="odd">
<td>你/妳得自己對新觀念開放嗎？</td>
<td>Are you open to new ideas?</td>
</tr>
<tr class="even">
<td>你/妳的大學對可環保性支持嗎？</td>
<td>Does your university support environmental sustainability?</td>
</tr>
</tbody>
</table>
<p>Respondents who remained outside the survey parameters were allowed to answer the survey however their responses were disregarded from the data analysis. References were stored in the Zotero paid version with 6 GB storage. Bibtex and Better Bibtex were used to export the references to the .bib format consumable by the Quarto scientific writing system.</p>
</section>
</section>
<section id="phase-three---qualitative-research" class="level3">
<h3 class="anchored" data-anchor-id="phase-three---qualitative-research">Phase Three - Qualitative Research</h3>
<p>In the third and last phase, I returned to qualitative methods, to further validate the quantitative findings from stage two, by building a prototype of the sustainable investing AI companion, taking into account insights gathered in the previous stage. Here my focus was on operationalizing the gathered insights into a prototype that users can experiment with. I designed and refined a prototype of the personal sustainable finance AI assistant. I used face-to-face interviews to discuss the prototype, and conducted a thematic analysis of the discussions’ recordings, leading to further validation of previously gathered data and changes in the prototype. The gained insights, accompanied by the app prototype, which embodies my findings, are the final outcome of my research.</p>
<section id="sampling-2" class="level4">
<h4 class="anchored" data-anchor-id="sampling-2">Sampling</h4>
<p>The phase three sampling structure used a judgmental criterion: - age Gen-Z cohort - located in Taiwan - Using Chinese for discussion.</p>
<p>Individual face-to-face interviews were organized at universities around Taiwan. Because in-person presence is required in this stage, the prototype will only be tested by potential users physically present in Taiwan. To avoid convenience sampling, I posted online ads in Chinese and reach out to varied student clubs to invite people who I don’t know personally, to participate in a “sustainable AI application testing” (wording may change).</p>
</section>
<section id="methods-2" class="level4">
<h4 class="anchored" data-anchor-id="methods-2">Methods</h4>
<p>Face-to-face prototype testing. The strength of in-person is the ability to observe potential users, where knowledge can be exchanged directly. The interviews were recorded and transcribed. Finally, I performed a thematic analysis of the interview transcriptions in order to validate previous findings, and open avenues for future research.</p>
<p>Interview transcripts from Descript and Google Speech-to-Text model were combined using Gemini 2.5 Pro Experimental 03-25 (gemini-2.5-pro-exp-03-25) model.</p>
</section>
<section id="prototype-testing" class="level4">
<h4 class="anchored" data-anchor-id="prototype-testing">Prototype Testing</h4>
<p>Does the prototype match user needs?</p>
<p>Testing was the most difficult part of the thesis process.</p>
<ul>
<li><p>Testing with random people found at the university.</p></li>
<li><p>Testing with experts.</p></li>
<li><p>Testing with unknown people in the target audience.</p></li>
</ul>
<p>App Testing Flow</p>
</section>
<section id="st-wave-of-preliminary-prototype-testing-spring-2024" class="level4">
<h4 class="anchored" data-anchor-id="st-wave-of-preliminary-prototype-testing-spring-2024">1st Wave of (Preliminary) Prototype Testing (Spring 2024)</h4>
<p>The 1st wave of preliminary testing took place during 1 month from 2024 April 2 to May 2, 2024 at the NCKU campus. I found 8 anonymous participants at different NCKU locations, such as the student canteens and the medical library, confirmed the people I approached were Taiwanese students studying at NCKU, and then simply asked them to test my app, using my own laptop. I made used of <em>participant observation</em> and took notes myself. There was no audio or video recording.</p>
</section>
<section id="nd-wave-of-in-production-prototype-testing-autumn-2024---spring-2025" class="level4">
<h4 class="anchored" data-anchor-id="nd-wave-of-in-production-prototype-testing-autumn-2024---spring-2025">2nd Wave of (In Production) Prototype Testing (Autumn 2024 - Spring 2025)</h4>
<p>The 2nd wave of testing took place from Autumn 2024 to Spring 2025 and was more comprehensive. I conducted in-person face-to-face testing individually with 32 students at 7 universities. Interviews were conducted in Chinese and transcribed and translated to English using Google Voice to Text AI as well as Describe AI.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 36%">
<col style="width: 36%">
</colgroup>
<tbody>
<tr class="odd">
<td>Region</td>
<td>University</td>
<td>No of Testees</td>
</tr>
<tr class="even">
<td>Taichung</td>
<td>國立中興大學 National Chung Hsing University (NCHU)</td>
<td>7</td>
</tr>
<tr class="odd">
<td>Chiayi</td>
<td>國立中正大學 National Chung Cheng University (CCU)</td>
<td>5</td>
</tr>
<tr class="even">
<td>Tainan</td>
<td>國立成功大學 National Cheng Kung University (NCKU)</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Tainan</td>
<td>國立臺南藝術大學 Tainan National University of the Arts (TNNUA)</td>
<td>2</td>
</tr>
<tr class="even">
<td>Tainan</td>
<td>長榮大學 Chang Jung Christian University (CJCU)</td>
<td>5</td>
</tr>
<tr class="odd">
<td>Tainan</td>
<td>南臺科技大學 Southern Taiwan University of Science and Technology (STUST)</td>
<td>5</td>
</tr>
<tr class="even">
<td>Pingtung</td>
<td>國立屏東科技大學 National Pingtung University of Science and Technology (NPUST)</td>
<td>2</td>
</tr>
</tbody>
</table>

</section>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-baytas3KindsDesign2020" class="csl-entry" role="listitem">
Baytaş, M. A. (2020). <em>3 <span>Kinds</span> of <span>Design Research</span>: <span>Research</span> for / into / through <span>Design</span></em>.
</div>
<div id="ref-christianrohrerWhenUseWhich2022" class="csl-entry" role="listitem">
Christian Rohrer. (2022). When to <span>Use Which User-Experience Research Methods</span>. In <em>Nielsen Norman Group</em>. https://www.nngroup.com/articles/which-ux-research-methods/.
</div>
<div id="ref-liuDigitalCapabilityDigital2023" class="csl-entry" role="listitem">
Liu, C.-H., Horng, J.-S., Chou, S.-F., Yu, T.-Y., Lee, M.-T. &amp; Lapuz, M. C. B. (2023). Digital capability, digital learning, and sustainable behaviour among university students in <span>Taiwan</span>: <span>A</span> comparison design of integrated mediation-moderation models. <em>The International Journal of Management Education</em>, <em>21</em>(3), 100835. <a href="https://doi.org/10.1016/j.ijme.2023.100835">https://doi.org/10.1016/j.ijme.2023.100835</a>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>